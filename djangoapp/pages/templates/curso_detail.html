{% extends 'base.html' %}
{% load static %}
{% block title %}Detalhes do Curso: {{ curso.nome }}{% endblock %}

{% block content %}
  <div class="mb-4">
    <h2 class="mb-3">{{ curso.nome }} <small class="text-muted">({{ curso.codigo }})</small></h2>
    <p class="lead">{{ curso.descricao|default:"Sem descrição." }}</p>
    <p><strong>Carga Horária Total:</strong> {{ curso.carga_horaria_total }} horas</p>
    <p><strong>Ativo:</strong> {{ curso.ativo|yesno:"Sim,Não" }}</p>
    <a href="{% url 'index' %}" class="btn btn-secondary mt-3">Voltar para Cursos</a>
  </div>

  <h3 class="mt-5 mb-3">Disciplinas</h3>
  <div class="mb-3">
    <input type="text" id="disciplinaSearchInput" class="form-control" placeholder="Pesquisar disciplinas por nome ou código...">
  </div>
  <div class="table-responsive" id="disciplinasTableContainer">
    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th scope="col">Código</th>
          <th scope="col">Nome</th>
          <th scope="col">Carga Horária</th>
          <th scope="col">Ativo</th>
        </tr>
      </thead>
      <tbody>
        {% if disciplinas.results or disciplinas %}
          {% for disciplina in disciplinas.results|default:disciplinas %}
          <tr>
            <td>{{ disciplina.codigo }}</td>
            <td>{{ disciplina.nome }}</td>
            <td>{{ disciplina.carga_horaria }}</td>
            <td>{{ disciplina.ativo|yesno:"Sim,Não" }}</td>
          </tr>
          {% endfor %}
        {% else %}
        <tr>
          <td colspan="4" class="text-center">Nenhuma disciplina encontrada para este curso.</td>
        </tr>
        {% endif %}
      </tbody>
      <tfoot>
        <tr>
          <th colspan="2">Total de Disciplinas Ativas:</th>
          <td colspan="2">{{ total_disciplinas_ativas }}</td>
        </tr>
        <tr>
          <th colspan="2">Soma da Carga Horária das Disciplinas Ativas:</th>
          <td colspan="2">{{ soma_carga_horaria_disciplinas_ativas }} horas</td>
        </tr>
      </tfoot>
    </table>
  </div>
{% endblock %}

{% block extra_js %}
{{ disciplinas|json_script:"disciplinas_data" }}
<script src="{% static 'js/curso_detail.js' %}"></script>
{% endblock %}
